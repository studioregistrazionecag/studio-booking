<!doctype html>
<html lang="it">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Registrati ‚Äî Studio Booking</title>
    <link rel="stylesheet" href="/frontend/assets/styles.css">
    <script src="/frontend/assets/ui.js"></script>
    <link rel="icon" type="image/x-icon" href="/frontend/assets/favicon.ico">
  </head>
  <body>
    <div class="hero-brand"><img src="/frontend/assets/logo.png" alt="W8 √ó CAG" class="hero-logo"></div>
    <div class="hero-separator"></div>
      <div class="card form">
        <h1>Crea account</h1>
        <div class="grid-1">
          <div class="field"><label class="label" for="name">Nome visualizzato</label>
            <div class="input-group"><input id="name" class="input" placeholder="Es. Mario Rossi" autocomplete="name"></div>
          </div>
          <div class="field"><label class="label" for="email">Email</label>
            <div class="input-group"><input id="email" class="input" type="email" placeholder="you@example.com" autocomplete="email"></div>
          </div>
          <div class="field"><label class="label" for="pwd">Password</label>
            <div class="input-group"><input id="pwd" class="input has-eye" type="password" placeholder="Crea una password" autocomplete="new-password"><button class="eye" onclick="togglePwd('pwd',this)">üëÅ</button></div>
            <div class="muted" style="font-size:.9rem">Minimo 8 caratteri</div>
          </div>
          <div class="field"><label class="label" for="role">Ruolo</label>
            <div class="input-group"><select id="role" class="input">
                <option value="ARTIST">Artista</option>
                <option value="PRODUCER">Producer</option>
              </select></div>
          </div>
          <div class="actions"><button class="btn btn-gold full" id="btnReg">Registrati</button></div>
          <div class="form-footer"><a href="/frontend/auth/login.html">Hai gi√† un account? Accedi</a></div>
        </div>
      </div>
    </div>
    <!-- Modale -->
    <div id="app-modal" class="modale nascosta" aria-hidden="true">
      <div class="modale__sfondo" data-chiudi="true"></div>
      <div class="modale__pannello" role="dialog" aria-modal="true" aria-labelledby="modale-titolo">
        <h3 id="modale-titolo" class="modale__titolo">Messaggio</h3>
        <p id="modale-testo" class="modale__testo"></p>
        <div class="modale__azioni">
          <button id="modale-annulla" class="btn" style="display:none">Annulla</button>
          <button id="modale-ok" class="btn btn-gold">OK</button>
        </div>
      </div>
    </div>
    <script>
      const API = location.origin;

      function togglePwd(id, btn) {
        const i = document.getElementById(id);
        i.type = i.type === 'password' ? 'text' : 'password';
        btn.textContent = i.type === 'password' ? 'üëÅ' : 'üôà';
      }
      async function register() {
        const display_name = document.getElementById('name').value.trim();
        const email = document.getElementById('email').value.trim();
        const password = document.getElementById('pwd').value.trim();
        const role = document.getElementById('role').value;
        if (!email || !password) return ui.avviso('Compila email e password.');
        const r = await fetch(`${API}/auth/register`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
            display_name,
            email,
            password,
            role
          })
        });
        const data = await r.json().catch(() => null);
        if (!r.ok) return ui.avviso(data?.detail || 'Errore registrazione');
        await ui.avviso('Account creato. Ora puoi accedere.');
        location.href = '/frontend/auth/login.html';
      }
      document.getElementById('btnReg').onclick = register;
    </script>
  <footer class="auth-footer">
  sviluppato da <a href="https://instagram.com/_lorenzocalifano" target="_blank" rel="noopener">@_lorenzocalifano</a>
</footer>
  </body>
</html>